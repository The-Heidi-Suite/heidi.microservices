# ============================================================================
# HEIDI Microservices - Environment Configuration
# ============================================================================
# Copy this file to .env: cp env.template .env
# Then update with your actual values
# ============================================================================

# ============================================================================
# Node Environment
# ============================================================================
NODE_ENV=development
SERVICE_VERSION=1.0.0

# ============================================================================
# PostgreSQL Server Configuration (Shared)
# ============================================================================
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=heidi
POSTGRES_PASSWORD=heidi_password

# ============================================================================
# Per-Service Database Configuration
# ============================================================================

# Auth Service (Port 3001)
AUTH_PORT=3001
AUTH_DB_NAME=heidi_auth
AUTH_DATABASE_URL=postgresql://heidi:heidi_password@localhost:5432/heidi_auth

# Users Service (Port 3002)
USERS_PORT=3002
USERS_DB_NAME=heidi_users
USERS_DATABASE_URL=postgresql://heidi:heidi_password@localhost:5432/heidi_users

# City Service (Port 3003)
CITY_PORT=3003
CITY_DB_NAME=heidi_city
CITY_DATABASE_URL=postgresql://heidi:heidi_password@localhost:5432/heidi_city

# Core Service (Port 3004)
CORE_PORT=3004
CORE_DB_NAME=heidi_core
CORE_DATABASE_URL=postgresql://heidi:heidi_password@localhost:5432/heidi_core

# Notification Service (Port 3005)
NOTIFICATION_PORT=3005
NOTIFICATION_DB_NAME=heidi_notification
NOTIFICATION_DATABASE_URL=postgresql://heidi:heidi_password@localhost:5432/heidi_notification

# Scheduler Service (Port 3006)
SCHEDULER_PORT=3006
SCHEDULER_DB_NAME=heidi_scheduler
SCHEDULER_DATABASE_URL=postgresql://heidi:heidi_password@localhost:5432/heidi_scheduler

# Integration Service (Port 3007)
INTEGRATION_PORT=3007
INTEGRATION_DB_NAME=heidi_integration
INTEGRATION_DATABASE_URL=postgresql://heidi:heidi_password@localhost:5432/heidi_integration

# Admin Service (Port 3008)
ADMIN_PORT=3008
ADMIN_DB_NAME=heidi_admin
ADMIN_DATABASE_URL=postgresql://heidi:heidi_password@localhost:5432/heidi_admin

# Terminal Service (Port 3009)
TERMINAL_PORT=3009
TERMINAL_DB_NAME=heidi_terminal
TERMINAL_DATABASE_URL=postgresql://heidi:heidi_password@localhost:5432/heidi_terminal

# ============================================================================
# Redis Configuration (Shared Cache)
# ============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_URL=redis://localhost:6379

# ============================================================================
# RabbitMQ Configuration (Shared Message Queue)
# ============================================================================
RABBITMQ_HOST=localhost
RABBITMQ_PORT=5672
RABBITMQ_MANAGEMENT_PORT=15672
RABBITMQ_PROMETHEUS_PORT=15692
RABBITMQ_USER=heidi
RABBITMQ_PASSWORD=heidi_password
RABBITMQ_VHOST=/
RABBITMQ_URL=amqp://heidi:heidi_password@localhost:5672
RABBITMQ_QUEUE=heidi_queue

# ============================================================================
# JWT Configuration - ⚠️  CHANGE IN PRODUCTION!
# ============================================================================
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production-min-32-chars
JWT_EXPIRES_IN=15m
JWT_REFRESH_SECRET=your-super-secret-refresh-key-change-this-in-production-min-32-chars
JWT_REFRESH_EXPIRES_IN=7d

# ============================================================================
# Logging Configuration
# ============================================================================
LOG_LEVEL=debug
LOG_DIR=./logs
ENABLE_FILE_LOGGING=false

# ============================================================================
# API Configuration
# ============================================================================
API_PREFIX=api
# Enable API gateway prefix for Swagger (set to 'true' for production/server)
# When enabled, Swagger will show /api/{service} paths; when disabled (local dev), no prefix
ENABLE_API_GATEWAY_PREFIX=false
# API Gateway Base URL (e.g., https://api.49.13.145.221.nip.io)
# If set, verification links and other service URLs will use this gateway URL
# Leave empty for local development (will use direct service URLs)
API_GATEWAY_BASE_URL=
CORS_ORIGIN=*
REQUEST_TIMEOUT_MS=30000

# ============================================================================
# Rate Limiting / Throttling
# ============================================================================
THROTTLE_TTL=60
THROTTLE_LIMIT=100

# ============================================================================
# Swagger/OpenAPI Documentation
# ============================================================================
SWAGGER_TITLE=HEIDI Microservices API
SWAGGER_DESCRIPTION=API documentation for HEIDI microservices
SWAGGER_VERSION=1.0

# ============================================================================
# Internationalization (i18n) Configuration
# ============================================================================
# Default language code (ISO 639-1) used when Accept-Language header is missing
I18N_DEFAULT_LANGUAGE=en

# Supported languages (comma-separated ISO 639-1 codes)
# Languages: de (German), en (English), dk (Danish), no (Norwegian), se (Swedish),
#            ar (Arabic), fa (Persian/Farsi), tr (Turkish), ru (Russian), uk (Ukrainian)
I18N_SUPPORTED_LANGUAGES=de,en,dk,no,se,ar,fa,tr,ru,uk

# ============================================================================
# Terms of Use Configuration
# ============================================================================
# Default locale for terms of use (e.g., 'en', 'de', 'ar')
TERMS_DEFAULT_LOCALE=en

# Grace period in days for users to accept updated terms (default: 7)
TERMS_GRACE_PERIOD_DAYS=7

# ============================================================================
# Email/SMTP Configuration
# ============================================================================
# Required: Email address used as the "from" address
SYSTEM_EMAIL_ID=noreply@heidi.example.com

# Required: SMTP server hostname
SMTP_HOST=smtp.gmail.com

# Required: SMTP authentication credentials
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-specific-password

# Optional: SMTP server port (leave empty for default port based on secure setting)
# Common ports: 25 (non-encrypted), 587 (TLS), 465 (SSL)
SMTP_PORT=587

# Optional: Use secure connection (SSL/TLS)
# Set to 'true' for port 465 (SSL), 'false' for port 587 (TLS) or 25 (plain)
# If not set, nodemailer will auto-detect based on port
SMTP_SECURE=false

# Optional: Custom path for SMTP server (e.g., "/webmail-rc" for some custom servers)
# Leave empty if not needed
SMTP_PATH=/webmail-rc

# Optional: TLS certificate validation
# Set to 'false' to allow self-signed certificates (useful for custom SMTP servers)
# Set to 'true' or leave empty for strict certificate validation (recommended for production)
SMTP_TLS_REJECT_UNAUTHORIZED=false

# ============================================================================
# Client/Frontend URL
# ============================================================================
CLIENT_URL=http://localhost:4200

# ============================================================================
# Monitoring & Alerting
# ============================================================================
SERVICE_NAME=heidi-service
METRICS_ENABLED=true

# Alert Webhook (optional)
ALERT_WEBHOOK_URL=

# Alert Email (optional)
ALERT_SMTP_HOST=smtp.gmail.com
ALERT_SMTP_PORT=587
ALERT_SMTP_USER=alerts@example.com
ALERT_SMTP_PASS=
ALERT_FROM_EMAIL=alerts@example.com
ALERT_TO_EMAILS=admin@example.com

# Slack Webhook (optional)
ALERT_SLACK_WEBHOOK_URL=

# ============================================================================
# Development/Debug Configuration (uncomment for debugging)
# ============================================================================
# DEBUG=*
# PRISMA_LOG_LEVEL=query,info,warn,error

# ============================================================================
# Docker Compose
# ============================================================================
COMPOSE_PROJECT_NAME=heidi

# ============================================================================
# Monitoring & Observability
# ============================================================================
# Prometheus
PROMETHEUS_PORT=9090

# Alertmanager
ALERTMANAGER_PORT=9093

# Grafana
GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin
GRAFANA_ALLOW_SIGN_UP=false
GRAFANA_ROOT_URL=http://localhost:3000

# Metrics Exporters
NODE_EXPORTER_PORT=9100
POSTGRES_EXPORTER_PORT=9187
REDIS_EXPORTER_PORT=9121

# ============================================================================
# Administration Tools
# ============================================================================
# pgAdmin
PGADMIN_PORT=5050
PGADMIN_EMAIL=admin@heidi.local
PGADMIN_PASSWORD=admin

# Redis Commander
REDIS_COMMANDER_PORT=8081
REDIS_COMMANDER_USER=admin
REDIS_COMMANDER_PASSWORD=admin

# ============================================================================
# Reverse Proxy (Nginx)
# ============================================================================
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443

# ============================================================================
# Reverse Proxy (Caddy) - Development with Auto SSL
# ============================================================================
# Development IP for nip.io domain (e.g., 192.168.1.100)
# Used to generate domain like: api.192.168.1.100.nip.io
DEV_IP=localhost

# Let's Encrypt email for SSL certificates
LETSENCRYPT_EMAIL=admin@heidi.com

# Use Let's Encrypt staging environment (set to 'true' for testing to avoid rate limits)
LETSENCRYPT_STAGING=false

# Caddy HTTP/HTTPS ports
CADDY_HTTP_PORT=80
CADDY_HTTPS_PORT=443

# React frontend build folder path (absolute or relative to docker-compose.yml)
# This is the path to your React app's build directory on the host machine
# Example: /home/user/projects/heidi-frontend/build
# Or relative: ../heidi-frontend/build
# Leave empty or unset if not serving a frontend
REACT_BUILD_PATH=../heidi-frontend/build
